<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í—¬ìŠ¤ì¼€ì–´ ì»¤ë®¤ë‹ˆí‹°</title>
    <link rel="stylesheet" href="Commu.css">
</head>
<body>
  <header class="header">
      <h1 class="iconme">
          <img class="icon" src="Untitled-2.png" alt="webicon">
          <p id="ti">ì›°ë¹™ì´ ì‚¶ì´ ë˜ëŠ”</p> <p id="TITLE"> 'í—¬ìŠ¤íƒ€'</p> 
      </h1>
  </header>

  <nav>
      <ul>
          <li><a href="Main.html" id="main">Main</a></li>
          <li><a href="profile.html" id="profile">Profile</a></li>
          <li><a href="Commu.html" id="Community">Community</a></li>
          <li><a href="mission.html" id="Settings">Settings</a></li>
      </ul>   
  </nav>

  <main class="content">
    <section class="post-container" id="post-container">
      <!-- ì—¬ê¸°ì— ì‚¬ìš©ì ê²Œì‹œë¬¼ í‘œì‹œ -->
    </section>
  </main>

  <footer class="footer">
    <p>Â© 2024 í—¬ìŠ¤ì¼€ì–´ ì»¤ë®¤ë‹ˆí‹°</p>
  </footer>

  <script>
      // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì—ì„œ ê²Œì‹œë¬¼ ë¶ˆëŸ¬ì˜¤ê¸°
      function loadPosts() {
          const posts = JSON.parse(localStorage.getItem('posts')) || [];
          const postContainer = document.getElementById('post-container');
          postContainer.innerHTML = ''; // ì´ˆê¸°í™”

          posts.forEach((post, index) => {
              const postElement = document.createElement('article');
              postElement.className = 'post';

              const postHeader = `
                  <div class="post-header">
                      <img src="user-icon.png" alt="${post.author}" class="user-image">
                      <h2 class="post-title">${post.author}ì˜ í•˜ë£¨</h2>
                  </div>
              `;
              
              const postImage = post.imageUrl ? `<img src="${post.imageUrl}" alt="ê²Œì‹œë¬¼ ì´ë¯¸ì§€" class="post-image">` : '';
              
              const postContent = `
                  ${postHeader}
                  ${postImage}
                  <p class="post-content">${post.content}</p>
                  <span class="post-author">ì‘ì„±ì: ${post.author}</span>
                  <div class="post-footer">
                      <button class="like-button" onclick="likePost(${index})">â¤ï¸ <span id="like-count-${index}">${post.likes || 0}</span></button>
                      <span class="comments">ğŸ’¬ <span id="comment-count-${index}">${post.comments ? post.comments.length : 0}</span></span>
                  </div>
                  <div class="comment-section" id="comment-section-${index}">
                      <input type="text" placeholder="ë³„ëª…" id="nickname-input-${index}">
                      <input type="text" placeholder="ëŒ“ê¸€ì„ ì…ë ¥í•˜ì„¸ìš”..." id="comment-input-${index}">
                      <button onclick="addComment(${index})">ëŒ“ê¸€ ë‹¬ê¸°</button>
                      <div class="comments-list" id="comments-list-${index}">
                          ${post.comments ? post.comments.map(comment => `<p><strong>${comment.nickname}:</strong> ${comment.text}</p>`).join('') : ''}
                      </div>
                  </div>
              `;
              
              postElement.innerHTML = postContent;
              postContainer.appendChild(postElement);
          });
      }

      // ì¢‹ì•„ìš” ê¸°ëŠ¥
      function likePost(index) {
          const posts = JSON.parse(localStorage.getItem('posts')) || [];
          posts[index].likes = (posts[index].likes || 0) + 1;
          localStorage.setItem('posts', JSON.stringify(posts));
          document.getElementById(`like-count-${index}`).innerText = posts[index].likes;
      }

      // ëŒ“ê¸€ ì¶”ê°€ ê¸°ëŠ¥
      function addComment(index) {
          const nicknameInput = document.getElementById(`nickname-input-${index}`);
          const commentInput = document.getElementById(`comment-input-${index}`);
          const nickname = nicknameInput.value.trim();
          const commentText = commentInput.value.trim();
          if (nickname === '' || commentText === '') return;

          const posts = JSON.parse(localStorage.getItem('posts')) || [];
          posts[index].comments = posts[index].comments || [];
          posts[index].comments.push({ nickname, text: commentText });
          localStorage.setItem('posts', JSON.stringify(posts));

          const commentsList = document.getElementById(`comments-list-${index}`);
          commentsList.innerHTML += `<p><strong>${nickname}:</strong> ${commentText}</p>`;
          nicknameInput.value = '';
          commentInput.value = '';

          // ëŒ“ê¸€ ìˆ˜ ì—…ë°ì´íŠ¸
          const commentCount = document.getElementById(`comment-count-${index}`);
          commentCount.innerText = posts[index].comments.length;
      }

      // í˜ì´ì§€ ë¡œë“œì‹œ ê²Œì‹œë¬¼ ë¡œë“œ
      document.addEventListener('DOMContentLoaded', loadPosts);
  </script>
</body>
</html>
